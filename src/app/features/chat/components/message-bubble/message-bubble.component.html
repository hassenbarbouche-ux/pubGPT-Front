<div class="message-wrapper" [class.user-message]="message.role === 'user'" [class.bot-message]="message.role === 'assistant'" [@slideDown]="message.role === 'assistant'">
  <!-- Avatar -->
  <div class="message-avatar" *ngIf="message.role === 'user'">
    <mat-icon class="avatar-icon">account_circle</mat-icon>
  </div>

  <div class="message-content-wrapper">
    <!-- N'afficher la bulle que si elle a du contenu ou si c'est un message user -->
    <mat-card class="message-bubble" *ngIf="message.role === 'user' || message.content || (message.streamingSteps && message.streamingSteps.length > 0) || message.hasJsonData">
      <mat-card-content>
        <!-- Contenu du message -->
        <div class="message-content" [innerHTML]="message.content"></div>

        <!-- Tableau JSON (si des données JSON sont présentes) -->
        <app-json-table *ngIf="message.hasJsonData && message.jsonData" [data]="message.jsonData"></app-json-table>

        <!-- Timestamp -->
        <div class="message-timestamp">
          {{ message.timestamp | date:'HH:mm' }}
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
